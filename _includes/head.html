<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{{ site.description }}">
	<link rel="icon" href="{{ "/images/calibre-viewer.png" | prepend: site.baseurl }}">
    <link rel="stylesheet" href="{{ "/css/main.css" | prepend: site.baseurl }}">
    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">
    <meta property="og:title" content="{{ site.title }}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ site.baseurl | prepend: site.url }}">
    <meta property="og:description" content="{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }} - {{ site.description }}">
    <meta property="og:image" content="{{ "/images/calibre-viewer.png" | prepend: site.baseurl }}">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="256">
    <meta property="og:image:height" content="256">
    <meta property="og:image:alt" content="A book with a magnifying glass">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jets/0.14.0/jets.min.js"></script>
    <script type="text/javascript">
    	function menuClick() {
    		if ( document.getElementById("menu").className.match(/(?:^|\s)show(?!\S)/) ) {
    			document.getElementById("menu").className = document.getElementById("menu").className.replace ( /(?:^|\s)show(?!\S)/g , '' )
    		}
    		else {
    			document.getElementById("menu").className += " show";
    		}
    		if ( document.getElementById("menu2").className.match(/(?:^|\s)show(?!\S)/) ) {
    			document.getElementById("menu2").className = document.getElementById("menu2").className.replace ( /(?:^|\s)show(?!\S)/g , '' )
    		}
    		else {
    			document.getElementById("menu2").className += " show";
    		}
  		}

        function schoolClick(e) {
            var schools = Array.prototype.slice.call(document.querySelectorAll('.spell-school:not([name="all"])')),
                selected = e.target,
                tags = [];

            if (selected.nodeName !== 'A') return;
            if (selected.name == 'all') {
                selected.classList.add('selected');
                schools.forEach(function(school) {
                    school.classList.remove('selected');
                });
            }
            else {
                document.querySelector('.spell-school[name="all"]').classList.remove('selected');
                selected.classList.toggle('selected');
                tags = Array.prototype.slice.call(document.querySelectorAll('.spell-school.selected')).map(function(el) { return el.name; });
            }

            filterSpells(tags);
        }

        /**
         * Hide/show spells based on presence of at least one of the given tags.
         */
        function filterSpells(tags) {
            var spells = document.querySelectorAll('.post-list li'),
                selector,
                unselected

            // Start by making previously hidden spells visible again
            // (this does not conflict with jets search filtering)
            Array.prototype.slice.call(spells).forEach(function(spell) {
                spell.style.display = '';
            });

            if (tags.length == 0) return;

            // Hide all spells where all of the given tags are not present
            selector = tags.map(function(tag) { return ':not([tags~="' + tag + '"])'; });
            unselected = document.querySelectorAll('.post-list .post-link' + selector.join(''));
            Array.prototype.slice.call(unselected).forEach(function(spell) {
                spell.parentNode.style.display = 'none';
            });
        }

  		window.onload = function(){
        document.getElementById("menuIcon").addEventListener( 'click' , menuClick );
        document.querySelector(".schools-list").addEventListener( 'click', schoolClick );
	    }
    </script>
    <script src="{{ '/js/search-common.js' | prepend: site.baseurl }}"></script>
    <script src="{{ '/js/tagsearch.js' | prepend: site.baseurl }}"></script>
    <script src="{{ '/js/sourcesearch.js' | prepend: site.baseurl }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js"></script>
    <script>
        WebFont.load({
            custom: {
                families: ['Linux Libertine', 'Linux Libertine Display'],
                urls: ['/fonts/libertine/linux-libertine/linux-libertine.css']
            }
        });
    </script>
</head>
